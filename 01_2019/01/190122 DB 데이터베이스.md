# DB 데이터베이스



## RDBMS(관계형 데이터베이스 관리 시스템)

- 관계형 모델을 기반으로 하는 데이터베이스 관리시스템이다.
- 대표적인 오픈소스 RDBMS : MySQL, SQLite, PostgreSQL
- ORACLE, MS SQL



## SQLite

- 서버가 아닌 응용 프로그램에 넣어 사용하는 비교적 가벼운 데이터베이스
- 구글 안드로이드 운영체제에 기본적으로 탑재된 데이터베이스이며, 임베디드 소프트웨어에도 많이 활용되고 있다.
- 로컬에서 간단한 DB 구성을 할 수 있으며, 오픈소스 프로젝트이기 때문에 자유롭게 사용할 수 있다.



## 데이터베이스 스키마

| column(받을 자료) | datatype |
| :---------------: | :------: |
|        id         |   int    |
|        age        |   int    |
|       phone       |   int    |
|       email       |   text   |

- DB 모델링이 끝나면 확정된 순간부터 schema(DB의 구조와 제약 조건에 관련한 전반적인 명세를 기술한 것)
- DB 모델링(id는 int, age는 int 등)
- table 생성(엑셀에서 sheet)
- row는 데이터 레코드가 쌓여나가는 역할
- schema는 데이터 레코드의 정의 역할
- 데이터 레코드가 들어가면 id가 자동 할당 되게



## sqlite3

- 문법 상 꼭 마지막에 `;`을 찍어야 함 (명령어는 다 대문자 이름은 내 맘대로라서 소문자 가능)

```sqlite
CREATE TABLE menus (id INTEGER, menu1 TEXT, menu2 TEXT);
menu1 뒤의 TEXT나 id 뒤의 INTEGER는 소문자로 써도 문제는 없음
만들고 확인할 때는 .tables로 있는지 확인 ; 필요 없음

INSERT INTO menus (id, menu1, menu2) 엔터 => id, menu1, menu2를 입력할 거란 얘기
values (1, "Pho", "Pork"); 순서대로 입력
SELECT id FROM menus WHERE id=1; menus의 id 1의 id를 선택
SELECT menu1 FROM menus WHERE id=1; menus의 id 1의 menu1을 선택
SELECT (menu1, menu2) FROM menus WHERE id=1; menus의 id 1의 menu1과 menu2를 선택
SELECT * FROM menus; menus의 전체 열을 선택
```



## Create, Read(Retrieve), Update, Delete(Destroy)

- 이거 4가지가 CRUD 오퍼레이션

### Table 생성

```sqlite
Table 생성 (Datatype: INTEGER, TEXT)
CREATE TABLE <table_name> (
    <col1> DATATYPE,
    <col2> DATATYPE,
    ...
    );
```

### Data 입력

```sqlite
INSERT INTO <tablename> (<col1>, <col2>, ...)
VALUES (<data1>, <data2>, ...);
```

### Data 조회

```sqlite
data 전체 조회
SELECT * FROM <table_name>;

id의 전체를 조회
SELECT * FROM <table_name> WHERE id=??;

특정 조건으로 조회
SELECT * FROM <table_name> WHERE 조건 ex) id>500;
```

### Data 수정 / 삭제

```sqlite
UPDATE <table_name>
SET col_1 = val_1, col_2 = val_2, ...
WHERE condition; -- 보통 primary key(id)로 선택

Data 삭제
DELETE FROM <table_name>
WHERE condition;
```

### Table에 반드시 들어가야 하는 데이터

```sqlite
NOT NULL을 붙인다
NOT NULL 부분을 입력하지 않으면 데이터 유효성 검사에 걸린다!

CREATE TABLE "users" (
    id INT PRIMARY KEY,
    first_name TEXT NOT NULL,
    last_name TEXT NOT NULL,
    age INT NOT NULL,
    country TEXT,
    phone TEXT,
    balance INT NOT NULL
);
INTEGER PRIMARY KEY` 최우선 키, 이렇게 해두면 id 입력 안 해줘도 됨
AUTOINCREMENT INT형에만 쓸 수 있음 ex) INT PRIMARY KEY AUTOINCREMENT
```

### Table 삭제

```sqlite
DROP TABLE <table_name>;
```

### Table 이름 수정

```sqlite
ALTER TABLE <table_name>
RENAME TO 바꿀 <table_name>;
```

### Expression

```sqlite
SELECT COUNT(<col>) FROM <table_name>;

해당 컬럼의 평균
SELECT AVG(<col>) FROM <table_name>;
총합 SUM
최소 MIN
최대 MAX
```

### 정렬(Order)

```sqlite
SELECT <col> FROM <table_name>;
ORDER BY <col_1>, <col_2> [ASC | DESC];
-- ASC 오름차순 DESC 내림차순
```

### 제한(Limit)

```sqlite
SELECT <col> FROM <table_name>
LIMIT <num>
```

### 패턴(pattern)

```sqlite
SELECT * FROM <table_name>
WHERE <col> LIKE '<pattern>'
```

| 시작 | 예시    | 설명                                   |
| ---- | ------- | -------------------------------------- |
| %    | `2%`    | 2로 시작하는 값                        |
|      | `%2`    | 2로 끝나는 값                          |
|      | `%2%`   | 2가 들어가는 값                        |
| _    | `_2`    | 두 번째 글자가 2인 값                  |
|      | `1____` | 1로 시작하며 4자리                     |
|      | `_2%`   | 한 글자 뒤에 2가 오고 뒤에 이어지는 값 |
|      | `2_%_%` | 2로 시작하는데 최소 3자리인 값         |



